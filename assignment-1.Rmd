---
title: "Assignment 1"
author: "Zack Wixom"
output: github_document
---

### WEEK 1 PROBLEMS

```{r}
# Load Packages
library(tidyverse)
library(rethinking)
```


1. Suppose the globe tossing data (Chapter 2) had turned out to be 4 water
in 15 tosses. Construct the posterior distribution, using grid approximation.
Use the same flat prior as in the book.

```
L W L W W L L W L L L L W L L 
```

```{r}
  # 1. Define the grid.
grid_appr <- tibble(grid = seq(from = 0, to = 1, length.out = 20)) %>% 
  # 2. Set the prior.
  mutate(prior = rep(1, 20)) %>% 
  # 3. Compute the likelihood.
  mutate(likelihood = dbinom(4, size = 15, prob = grid)) %>% 
  # 4. Compute the unstandardized posterior.
  mutate(unstd_posterior = likelihood * prior) %>% 
  # 5. Standardize the posterior.
  mutate(posterior = unstd_posterior / sum(unstd_posterior))

grid_appr

# Plot the grid approximation
ggplot(grid_appr, aes(x = grid, y = posterior)) +
  geom_line()

```

2. Start over in 1, but now use a prior that is zero below p = 0.5 and a constant above p = 0.5. This corresponds to prior information that a majority of the Earthâ€™s surface is water. What difference does the better prior make?

```{r}

  # 1. Define the grid.
grid_appr <- tibble(grid = seq(from = 0, to = 1, length.out = 20)) %>% 
  # 2. Set the prior.
  mutate(prior = ifelse(grid < 0.5 , 0 , 1) ) %>% 
  # 3. Compute the likelihood.
  mutate(likelihood = dbinom(4, size = 15, prob = grid)) %>% 
  # 4. Compute the unstandardized posterior.
  mutate(unstd_posterior = likelihood * prior) %>% 
  # 5. Standardize the posterior.
  mutate(posterior = unstd_posterior / sum(unstd_posterior))

grid_appr

# Plot the grid approximation
ggplot(grid_appr, aes(x = grid, y = posterior)) +
  geom_line()

```


3. For the posterior distribution from 2, compute 89% percentile and HPDI
intervals. Compare the widths of these intervals. Which is wider? Why? If
you had only the information in the interval, what might you misunderstand
about the shape of the posterior distribution?

```{r}

# Sample
grid_appr_sample <- sample(
  grid_appr$grid, 
  prob = grid_appr$posterior, 
  size = 10000, 
  replace = TRUE
)

# Percentile
PI(grid_appr_sample, prob = 0.89)

# HPDI
HPDI(grid_appr_sample, prob = 0.89)


```


_Questions from the assignment:_

- How do you determine the size of the grid. In the book he did 20 with only 9 tosses. Is it normal to make your grid larger than your number of observed data? Why not make them the same?

- Does the size matter when sampling form the posterior?

- How do you plot the PI and HPDI on a existing graph? Is there a way to add the shading?







